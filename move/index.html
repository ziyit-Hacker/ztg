<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>ZIYIT more</title>
    <link rel="icon" href="../assets/ziyit.png" type="image/x-icon">
    <script src="../assets/f12check.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @media (max-width: 768px) {

            /* 手机端样式 */
            body {
                font-size: 16px;
            }

            div[style*="max-width: 400px"] {
                width: 90%;
                margin: 10px auto;
                padding: 15px;
            }

            input,
            select {
                width: 100%;
            }

            button {
                width: 100%;
                padding: 12px;
            }
        }
    </style>
    <style>
        body {
            background-color: #0b99fa;
        }

        nav {
            display: flex;
            justify-content: space-between;
            padding: 10px;
        }

        .product-grid {
            display: flex;
            flex-wrap: wrap;
        }

        .brg {
            text-align: left;
        }

        .brg:hover {
            cursor: crosshair;
        }

        .cpg:hover {
            cursor: help;
        }

        .cpg:active {
            cursor: wait;
        }

        a {
            text-decoration: none;
        }

        .ceors {
            background: url(../assets/ziyit_miv.png);
            width: 970px;
            height: 142px;
        }

        h1:hover,
        h4:hover,
        h3:hover,
        p:hover,
        br:hover {
            cursor: default;
        }

        button {
            background-color: #0078d4;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        * {
            cursor: default !important;
        }
    </style>
</head>

<body background="../assets/bgl.jpg" style=" background-repeat:no-repeat ;
        background-size:100% 100%;
        background-attachment: fixed;">
    <script>
        // 检查用户权限
        function checkUserPermission() {
            const authToken = localStorage.getItem('authToken');
            if (!authToken) {
                alert('请先登录以访问该页面');
                window.location.href = './';
                return;
            }
        }

        // 页面加载时检查权限
        document.addEventListener('DOMContentLoaded', checkUserPermission);
    </script>
    <a href="../">返回主页</a>
    <hr class="brg">
    <h1 id="up">欢迎来到只因更多主页</h1>
    <h4>我们会提供对你们有帮助的工具，使用商业版需要产品密钥或额外付费，部分为商业VIP使用！</h4>
    <h3>以下是只因科技提供的产品，请自行查看</h3>
    <hr class="brg" />
    <!-- <video crossorigin="anonymous" preload="auto"
        src="blob:https://www.bilibili.com/e5e94ab6-b01f-446b-b3ba-d9dd38366f4a"></video>
    <hr class="brg"> -->
    <a href="mod">点我去“Minecraft_寒坤”的病毒库</a>
    <br>
    <a href="#" id="key">获得云储存提交密钥</a>
    <br>
    <a href="#up">
        <img src="../assets/up.png" alt="到顶部">
    </a>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <p>&copy;2025&nbsp;&nbsp;ZIYIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>版权所有，侵权必究</strong></p>
    <script>
        let isPlay = false;
        const audio = document.querySelector('audio');
        const bgmList = ['../assets/bm.mp3', '../assets/bm2.mp3', '../assets/bm3.mp3', '../assets/bm4.mp3'];

        function selectRandomBgm() {
            const randomIndex = Math.floor(Math.random() * bgmList.length);
            return bgmList[randomIndex];
        }

        audio.loop = false;

        audio.addEventListener('ended', () => {
            audio.src = selectRandomBgm();
            if (isPlay) {
                audio.play().catch((error) => {
                    console.error('切换播放音频失败:', error);
                });
            }
        });
        const playAudioOnInteraction = () => {
            if (!isPlay) {
                audio.src = selectRandomBgm();
                audio.play()
                    .then(() => {
                        isPlay = true;
                        const events = ['mousemove', 'click', 'touchstart', 'keydown', 'mousedown'];
                        events.forEach((event) => {
                            document.removeEventListener(event, playAudioOnInteraction);
                        });
                    })
                    .catch((error) => {
                        console.error('播放音频失败:', error);
                    });
            }
        };
        const interactionEvents = ['mousemove', 'click', 'touchstart', 'keydown', 'mousedown'];
        interactionEvents.forEach((event) => {
            document.addEventListener(event, playAudioOnInteraction);
        });

        audio.addEventListener('click', () => {
            if (isPlay) {
                audio.pause();
                isPlay = false;
            } else {
                audio.play()
                    .then(() => {
                        isPlay = true;
                    })
                    .catch((error) => {
                        console.error('切换播放音频失败:', error);
                    });
            }
        });
        toggle();
    </script>

    <script>
        // 添加密钥获取功能
        document.getElementById('key').addEventListener('click', function(e) {
            e.preventDefault();
            
            const authToken = localStorage.getItem('authToken');
            
            // 检查登录状态
            if (!authToken) {
                window.location.href = '../user/';
                return;
            }
            
            // 解析token
            const [type, username, password] = authToken.split('-');
            
            // 检查权限
            if (type === 'UR') {
                alert("此功能仅VIP可用");
                return;
            }
            
            // 如果是VIP用户，从key.txt获取随机密钥
            if (type === 'ZC') {
                fetch('./key.txt')
                    .then(response => response.text())
                    .then(data => {
                        const keys = data.split('\n').filter(key => key.trim() !== '');
                        if (keys.length === 0) {
                            alert("密钥文件为空");
                            return;
                        }
                        
                        // 随机选择一行密钥
                        const randomIndex = Math.floor(Math.random() * keys.length);
                        const upk = keys[randomIndex].trim();
                        
                        // 生成时间戳
                        const now = new Date();
                        const timeStr = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}${now.getHours().toString().padStart(2, '0')}${now.getMinutes().toString().padStart(2, '0')}`;
                        
                        // 创建用户信息字符串
                        const user = `${type}-${username}-${password}`;
                        const message = `请将网盘获取代码：${user}/${upk}\\${timeStr}用短信发送到13258227085`;
                        
                        // 创建提示框
                        const msgDiv = document.createElement('div');
                        msgDiv.style.position = 'fixed';
                        msgDiv.style.top = '50%';
                        msgDiv.style.left = '50%';
                        msgDiv.style.transform = 'translate(-50%, -50%)';
                        msgDiv.style.backgroundColor = 'white';
                        msgDiv.style.padding = '20px';
                        msgDiv.style.borderRadius = '8px';
                        msgDiv.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';
                        msgDiv.style.zIndex = '1000';
                        msgDiv.style.textAlign = 'center';

                        const msgText = document.createElement('p');
                        msgText.textContent = message;
                        msgDiv.appendChild(msgText);

                        const confirmBtn = document.createElement('button');
                        confirmBtn.textContent = '已发送，回到主页';
                        confirmBtn.style.marginTop = '15px';
                        confirmBtn.onclick = function () {
                            window.location.href = '../';
                        };
                        msgDiv.appendChild(confirmBtn);

                        document.body.appendChild(msgDiv);

                        // 复制到剪贴板
                        navigator.clipboard.writeText(`${user}/${upk}\\${timeStr}`);
                    })
                    .catch(error => {
                        console.error('读取密钥文件失败:', error);
                        alert("读取密钥文件失败");
                    });
            }
        });
    </script>
</body>

</html>
